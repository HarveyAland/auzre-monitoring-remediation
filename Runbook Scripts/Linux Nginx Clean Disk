# Linux VM - Clean Disk
$rg = "aim-dev-rg"
$vm = "lin-nginx-01"

Connect-AzAccount -Identity | Out-Null

$script = @"
if command -v apt >/dev/null 2>&1; then sudo apt-get clean; fi
if command -v yum >/dev/null 2>&1; then sudo yum clean all; fi
if command -v journalctl >/dev/null 2>&1; then sudo journalctl --vacuum-size=200M; fi
sudo find /var/log -type f -name '*.gz' -delete 2>/dev/null || true
sudo find /var/log -type f -name '*.[0-9]' -delete 2>/dev/null || true
df -h
"@

$result = Invoke-AzVMRunCommand -ResourceGroupName $rg -Name $vm `
  -CommandId 'RunShellScript' -ScriptString $script

Write-Output $result.Value.Message
